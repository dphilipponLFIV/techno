<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>LFIV Semaine des Arts</title>
    <script src="https://aframe.io/releases/1.3.0/aframe.min.js"></script>
    <script src="https://raw.githack.com/AR-js-org/AR.js/dev/aframe/build/aframe-ar.js"></script>
    <style>
      #hud {
        position: fixed;
        top: 20px;
        left: 20px;
        background: rgba(0,0,0,0.7);
        color: white;
        padding: 15px;
        border-radius: 8px;
        display: none;
        z-index: 1000;
        min-width: 200px;
        font-size: 1.2em;
        max-height: 300px;
        width: 30%; 
        overflow: scroll;
      }
      strong {
        color: #FFD700;
      }
      h2 {
        margin-top: 0;
        margin-bottom: 8px;
        color: #99ccff;
      }
    </style>
  </head>
  <body style="margin:0;">
    <div id="hud"></div>
    <a-scene embedded arjs>
      <!-- Marqueur personnalisé AkFa -->
      <a-marker id="AkFa" type="pattern" url="https://dphilipponlfiv.github.io/techno/markers/pattern-output_AkFa.patt">
        <a-entity 
            gltf-model="https://dphilipponlfiv.github.io/techno/textures/pieta.gltf"
            position="-1 0 0"
            scale="0.025 0.025 0.025"
            rotation="-90 0 0">
        </a-entity>
      </a-marker>

      <a-entity camera></a-entity>
    </a-scene>

    <script>
      const markerInfos = {
        AkFa: {
          titre: "La Pietà",
          auteur: "Michel-Ange",
          annee: "1498-1499",
          lieu: "Basilique Saint-Pierre, Vatican, Rome",
          description: "La Pietà (prononcé : [pjeˈta]) est un groupe en marbre représentant la Vierge Marie tenant le corps du Christ descendu de la Croix, sculpté entre 1498 et 1499.",
          opinion: "Chef-d'œuvre emblématique de la Renaissance, la Pietà impressionne par la délicatesse de ses détails et l'émotion qu'elle suscite."
        }
      };

      // Génère le HTML du HUD
      function generateHudContent(info) {
        return `
          <h2>${info.titre}</h2>
          <strong>Auteur :</strong> ${info.auteur}<br/>
          <strong>Année :</strong> ${info.annee}<br/>
          <strong>Lieu :</strong> ${info.lieu}<br/><br/>
          <strong>Description :</strong><br/>${info.description}<br/><br/>
          <strong>Opinion :</strong><br/>${info.opinion}
        `;
      }

      // Gestion des événements
      const hud = document.getElementById('hud');
      let currentVisibleMarker = null;

      Object.keys(markerInfos).forEach(markerId => {
        const marker = document.getElementById(markerId);
        const entity = marker.querySelector('a-entity, a-sphere');

        marker.addEventListener('markerFound', () => {
          if (currentVisibleMarker !== markerId) {
            // Affiche le HUD
            hud.innerHTML = generateHudContent(markerInfos[markerId]);
            hud.style.display = 'block';
            
            // Affiche le modèle 3D
            currentVisibleMarker = markerId;
          }
        });

        marker.addEventListener('markerLost', () => {
          if (currentVisibleMarker === markerId) {
            // Masque le HUD
            hud.style.display = 'none';
            
            // Masque le modèle 3D
            currentVisibleMarker = null;
          }
        });
      });
    </script>
  </body>
</html>
